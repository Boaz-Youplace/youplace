# -*- coding: utf-8 -*-
from tokenize import Double
import pymysql
from decimal import Decimal

# 사용자 생성 후 권한 부여해줘야함
# mysql> CREATE USER '{username}'@'localhost' IDENTIFIED BY '{password}';
# mysql> CREATE USER '{username}'@'%' IDENTIFIED BY '{password}';
# mysql> GRANT ALL PRIVILEGES ON {database}.* TO '{username}'@'localhost';
# mysql> FLUSH PRIVILEGES;

db = None

try:
    db = pymysql.connect(host='localhost', user='root', passwd='rudalsdl!!99',db='youplace',charset='utf8')
    print("DB connection success")
    # create Table
    sql = '''
    create table youplace_test(
        id varchar(32) not null,
        place_name varchar(50) not null,
        viewCount int,
        publishTime varchar(50),
        likeCount int,
        x decimal(24,18),
        y decimal(24,18),
        category varchar(32),
        place_url varchar(100),
        address_6 varchar(32),
        primary key(id,place_name)
        )
        ''' 
        #engine = InnoEB default charset=utf8

    with db.cursor() as cursor:
        cursor.execute(sql)


    data =[{'place_name': ['하례감귤체험농장'], 'x': ['126.681109358351'], 'y': ['33.29927202034467'], 'place_url': 'http://place.map.kakao.com/1228554077', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['비밀의숲'], 'x': ['126.75493209633262'], 'y': ['33.45360917744684'], 'place_url': 'http://place.map.kakao.com/82389937', 'category': '관광,명소', 'address_6': '조천,구좌,우도(제주시 동부)', 'id': 'Nk9ltFZIojc', 'publishTime': '2022-01-09T14:31:35Z', 'likeCount': '12', 'viewCount': '184'}, {'place_name': ['숙성도 노형점'], 'x': ['126.48503012387'], 'y': ['33.4850301883515'], 'place_url': 'http://place.map.kakao.com/316010726', 'category': '음식점', 'address_6': '제주시내(제주시 중부)', 'id': 'Nk9ltFZIojc', 'publishTime': '2022-01-09T14:31:35Z', 'likeCount': '12', 'viewCount': '184'}, {'place_name': ['신창풍차해안도로'], 'x': ['126.17420604655737'], 'y': ['33.343081026740045'], 'place_url': 'http://place.map.kakao.com/26239274', 'category': '관광,명소', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'Nk9ltFZIojc', 'publishTime': '2022-01-09T14:31:35Z', 'likeCount': '12', 'viewCount': '184'}, {'place_name': ['한림민속5일시장'], 'x': ['126.274162655324'], 'y': ['33.4201857861824'], 'place_url': 'http://place.map.kakao.com/19397053', 'category': '가정,생활', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['올레길 7코스(서귀포-월평 올레)'], 'x': ['126.51530966206293'], 'y': ['33.23738579332568'], 'place_url': 'http://place.map.kakao.com/11635431', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['올레길 16코스(고내-광령 올레)'], 'x': ['126.38979561557086'], 'y': ['33.46649759191228'], 'place_url': 'http://place.map.kakao.com/11943943', 'category': '관광,명소', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['금오름'], 'x': ['126.30583886304309'], 'y': ['33.354572330015976'], 'place_url': 'http://place.map.kakao.com/25189061', 'category': '관광,명소', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['사계해변'], 'x': ['126.3085978558'], 'y': ['33.2286582703756'], 'place_url': 'http://place.map.kakao.com/11055702', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['천지연폭포'], 'x': ['126.55452234287986'], 'y': ['33.24721231608811'], 'place_url': 'http://place.map.kakao.com/8100102', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['오지힐제주'], 'x': ['126.193542396231'], 'y': ['33.3626635156894'], 'place_url': 'http://place.map.kakao.com/717162944', 'category': '카페', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['너븐'], 'x': ['126.574103781235'], 'y': ['33.2453333881799'], 'place_url': 'http://place.map.kakao.com/918913333', 'category': '카페', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['카페노티드 제주애월'], 'x': ['126.30972281394814'], 'y': ['33.46327184686136'], 'place_url': 'http://place.map.kakao.com/1775255132', 'category': '카페', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'sV2x0VR13rQ', 'publishTime': '2022-01-14T11:51:25Z', 'likeCount': '1', 'viewCount': '18'}, {'place_name': ['비오는날의숲'], 'x': ['126.618888168088'], 'y': ['33.5372692705091'], 'place_url': 'http://place.map.kakao.com/107207250', 'category': '음식점', 'address_6': '조천,구좌,우도(제주시 동부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['빛의 벙커'], 'x': ['126.89981394705958'], 'y': ['33.43964657077559'], 'place_url': 'http://place.map.kakao.com/1682547680', 'category': '문화,예술', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['에곤'], 'x': ['126.918199053612'], 'y': ['33.4399179214926'], 'place_url': 'http://place.map.kakao.com/808885837', 'category': '카페', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['올레길 1코스(시흥-광치기 올레)'], 'x': ['126.90636648646604'], 'y': ['33.47866074455451'], 'place_url': 'http://place.map.kakao.com/10626234', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['제주도'], 'x': ['126.54587355630036'], 'y': ['33.379777816446165'], 'place_url': 'http://place.map.kakao.com/18514310', 'category': '관광,명소', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['해안도로입구 금릉동쪽방면'], 'x': ['126.235390181823'], 'y': ['33.38958381913'], 'place_url': 'http://place.map.kakao.com/26136297', 'category': '관광,명소', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['서쪽사진관'], 'x': ['126.241506673732'], 'y': ['33.3555375871335'], 'place_url': 'http://place.map.kakao.com/2020380834', 'category': '문화,예술', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'xsZJWeeJt7U', 'publishTime': '2021-11-06T13:47:14Z', 'likeCount': '9', 'viewCount': '266'}, {'place_name': ['애월읍도도리'], 'x': ['126.376234324567'], 'y': ['33.4810069563225'], 'place_url': 'http://place.map.kakao.com/909041447', 'category': '가정,생활', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'xsZJWeeJt7U', 'publishTime': '2021-11-06T13:47:14Z', 'likeCount': '9', 'viewCount': '266'}, {'place_name': ['베리제주'], 'x': ['126.3363096719503'], 'y': ['33.46661766524685'], 'place_url': 'http://place.map.kakao.com/1220762226', 'category': '여행', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'xsZJWeeJt7U', 'publishTime': '2021-11-06T13:47:14Z', 'likeCount': '9', 'viewCount': '266'}, {'place_name': ['달빛제주'], 'x': ['126.394451654199'], 'y': ['33.4837768209289'], 'place_url': 'http://place.map.kakao.com/1358103055', 'category': '카페', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'xsZJWeeJt7U', 'publishTime': '2021-11-06T13:47:14Z', 'likeCount': '9', 'viewCount': '266'}, {'place_name': ['수풀'], 'x': ['126.26566914886867'], 'y': ['33.4145495634761'], 'place_url': 'http://place.map.kakao.com/752459708', 'category': '가정,생활', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'xsZJWeeJt7U', 'publishTime': '2021-11-06T13:47:14Z', 'likeCount': '9', 'viewCount': '266'}, {'place_name': ['사계여행'], 'x': ['126.307758644674'], 'y': ['33.2349577089985'], 'place_url': 'http://place.map.kakao.com/10457837', 'category': '숙박', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'Nk9ltFZIojc', 'publishTime': '2022-01-09T14:31:35Z', 'likeCount': '12', 'viewCount': '184'}, {'place_name': ['조금만천천히'], 'x': ['126.634692385685'], 'y': ['33.5353478230289'], 'place_url': 'http://place.map.kakao.com/1642124500', 'category': '카페', 'address_6': '조천,구좌,우도(제주시 동부)', 'id': 'Nk9ltFZIojc', 'publishTime': '2022-01-09T14:31:35Z', 'likeCount': '12', 'viewCount': '184'}, {'place_name': ['재활용도움센터'], 'x': ['126.5476660195'], 'y': ['33.4714279115632'], 'place_url': 'http://place.map.kakao.com/2077575399', 'category': '가정,생활', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['둘째네 펜박'], 'x': ['126.802485051695'], 'y': ['33.3081005098631'], 'place_url': 'http://place.map.kakao.com/800866773', 'category': '숙박', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['날'], 'x': ['126.5162808550609'], 'y': ['33.504302322879184'], 'place_url': 'http://place.map.kakao.com/1685442727', 'category': '가정,생활', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['쉐프의 스시이야기'], 'x': ['126.489793032535'], 'y': ['33.4889483728388'], 'place_url': 'http://place.map.kakao.com/18731137', 'category': '음식점', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['제주와서'], 'x': ['126.17982356573648'], 'y': ['33.33293297909793'], 'place_url': 'http://place.map.kakao.com/794733878', 'category': '숙박', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['너무늘보'], 'x': ['126.308771631116'], 'y': ['33.2311152415353'], 'place_url': 'http://place.map.kakao.com/24355818', 'category': '카페', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['그래도감성공방'], 'x': ['126.65604843693619'], 'y': ['33.27437072013748'], 'place_url': 'http://place.map.kakao.com/251906481', 'category': '문화,예술', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['또오크라'], 'x': ['126.390545073028'], 'y': ['33.4700787835227'], 'place_url': 'http://place.map.kakao.com/27294569', 'category': '숙박', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['바람이머무는곳'], 'x': ['126.317457799385'], 'y': ['33.4672816458339'], 'place_url': 'http://place.map.kakao.com/1032727268', 'category': '카페', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['생각하는정원'], 'x': ['126.25499737444586'], 'y': ['33.32549870599322'], 'place_url': 'http://place.map.kakao.com/27539430', 'category': '여행', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['그계절'], 'x': ['126.818530919106'], 'y': ['33.5318587572743'], 'place_url': 'http://place.map.kakao.com/59334207', 'category': '카페', 'address_6': '조천,구좌,우도(제주시 동부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['같이살자지구카페'], 'x': ['126.78441854469573'], 'y': ['33.471317423257766'], 'place_url': 'http://place.map.kakao.com/155242847', 'category': '카페', 'address_6': '조천,구좌,우도(제주시 동부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['무조건노래연습장'], 'x': ['126.473588227203'], 'y': ['33.4825586370201'], 'place_url': 'http://place.map.kakao.com/23641827', 'category': '가정,생활', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['안'], 'x': ['126.494603484669'], 'y': ['33.4854969536786'], 'place_url': 'http://place.map.kakao.com/1577935056', 'category': '음식점', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['제주에가면'], 'x': ['126.51800319743411'], 'y': ['33.514709782977775'], 'place_url': 'http://place.map.kakao.com/1929674581', 'category': '음식점', 'address_6': '제주시내(제주시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['신창리경로복지회관'], 'x': ['126.182227369465'], 'y': ['33.3483272660795'], 'place_url': 'http://place.map.kakao.com/18517220', 'category': '가정,생활', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['뚜벅이게스트하우스'], 'x': ['126.16590494014598'], 'y': ['33.30845492168696'], 'place_url': 'http://place.map.kakao.com/344135962', 'category': '숙박', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['올레길 2코스(광치기-온평 올레)'], 'x': ['126.90186955925942'], 'y': ['33.44016934645293'], 'place_url': 'http://place.map.kakao.com/12753467', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['서귀포매일올레시장'], 'x': ['126.56323157639459'], 'y': ['33.25015006260236'], 'place_url': 'http://place.map.kakao.com/7938166', 'category': '가정,생활', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['저바다에누워펜션'], 'x': ['126.20511979700957'], 'y': ['33.367225391099446'], 'place_url': 'http://place.map.kakao.com/1612470581', 'category': '숙박', 'address_6': '애월,한림,한경(제주시 서부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['해왓'], 'x': ['126.917189510552'], 'y': ['33.4384927031139'], 'place_url': 'http://place.map.kakao.com/382375401', 'category': '음식점', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['제주수요일'], 'x': ['126.696548214586'], 'y': ['33.2805739060772'], 'place_url': 'http://place.map.kakao.com/789053537', 'category': '문화,예술', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'}, {'place_name': ['갑마장길및가름질 쫄븐갑마장길'], 'x': ['126.74190398680706'], 'y': ['33.394581263739724'], 'place_url': 'http://place.map.kakao.com/26564491', 'category': '관광,명소', 'address_6': '서귀포시(서귀포시 중부)', 'id': 'X78E3bp5-0s', 'publishTime': '2021-05-18T00:29:20Z', 'likeCount': '7', 'viewCount': '250'},]

    # 다수의 데이터 삽입
    for d in data:
        with db.cursor() as cursor:
            sql = '''
            insert into youplace_test(id,place_name,x,y,place_url,category,address_6,publishTime,likeCount,viewCount) values (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)
            '''
            cursor.execute(sql,(d['id'],d['place_name'][0],Decimal(d['x'][0]),Decimal(d['y'][0]),d['place_url'],d['category'],d['address_6'],d['publishTime'],int(d['likeCount']),int(d['viewCount'])))
            
    db.commit()

except Exception as e:
    print(e)

finally:
    if db is not None:
        db.close()
        print("DB connection close success")